min(surface_table$block_id)
max(surface_table$block_id)
max(surface_table$block_id) - min(surface_table$block_id) + 1 == length(unique(surface_table$block_id))
table(table(surface_table$block_id))
apply(surface_table, 2, function(x){sum(is.na(x))})
write.csv(surface_table, "../data/output/fallahi/surface.csv", row.names = FALSE)
rm(list = ls())
drug_index <- read.csv("../data/tmp/fallahi/drug_id_change_table.csv",
stringsAsFactors = FALSE)
drug_index <- read.csv("../../2020.11.30_update_drug_table/data/output/drug_id_change_table.csv",
stringsAsFactors = FALSE)
block_index <- read.csv("../data/tmp/fallahi/block_index.csv", stringsAsFactors = FALSE)
curve_table <- read.csv("../data/raw/fallahi_result/Upload/calculate/curve_fin.csv",
stringsAsFactors = FALSE, header = TRUE)
drug_index <- read.csv("../../2020.11.30_update_drug_table/data/output/drug_id_change_table.csv",
stringsAsFactors = FALSE)
block_index <- read.csv("../data/tmp/fallahi/block_index.csv", stringsAsFactors = FALSE)
curve_table <- read.csv("../data/raw/Fallahi_melanuma_result/Upload/calculate/curve_fixed.csv",
stringsAsFactors = FALSE, header = TRUE)
min(curve_table$block_id)
max(curve_table$block_id)
max(curve_table$block_id) - min(curve_table$block_id) + 1 == nrow(curve_table) / 2
table(table(curve_table$block_id))
apply(curve_table, 2, function(x){sum(is.na(x))})
for (i in 1:nrow(drug_index)) {
curve_table$drug_row[which(curve_table$drug_row == drug_index$old_id[i])] <- drug_index$new_id[i]
curve_table$drug_col[which(curve_table$drug_col == drug_index$old_id[i])] <- drug_index$new_id[i]
}
curve_table <- curve_table %>%
left_join(block_index, by = c("block_id" = "old_id")) %>%
select(block_id = new_id, b, c, d, e, model, drug_row_id = drug_row,
drug_col_id = drug_col) %>%
unique()
min(curve_table$block_id)
max(curve_table$block_id)
max(curve_table$block_id) - min(curve_table$block_id) + 1 == nrow(curve_table) / 2
table(table(curve_table$block_id))
apply(curve_table, 2, function(x){sum(is.na(x))})
View(curve_table)
write.csv(curve_table, "../data/output/fallahi/curve.csv", row.names = FALSE)
rm(list = ls())
assay_table <- read.csv("../data/raw/fallahi_result/Upload/assay_fin_shuyu_modified.csv",
stringsAsFactors = FALSE)
assay_table <- read.csv("../data/raw/Fallahi_melanuma_result/Upload/assay.csv",
stringsAsFactors = FALSE)
assay_table <- assay_table %>%
rename(old_assay_id = assay_id) %>%
mutate(assay_id = seq(148, length.out = n()))
assay_index <- assay_table %>%
select(old_assay_id, new_assay_id = assay_id)
assay_table <- assay_table %>%
select(assay_id, assay_type, plate_format, cell_per_well, detection_technology,
negative_control, negative_control_conc, positive_control,
positive_control_conc_nm, time_h)
View(assay_table)
View(assay_table)
write.csv(source_table, "../data/output/fallahi/source.csv", row.names = FALSE)
write.csv(assay_table, "../data/output/fallahi/assay.csv", row.names = FALSE)
write.csv(assay_index, "../data/tmp/fallahi/assay_index.csv", row.names = FALSE)
rm(list = ls())
assay_index <- read.csv("../data/tmp/fallahi/assay_index.csv", stringsAsFactors = FALSE)
study_index <- read.csv("../data/tmp/study_index.csv", stringsAsFactors = FALSE)
block_index <- read.csv("../data/tmp/fallahi/block_index.csv",
stringsAsFactors = FALSE)
source_table <- read.csv("../data/raw/fallahi_result/Upload/source.csv",
stringsAsFactors = FALSE) %>%
left_join(assay_index, by = c("assay_id" = "old_assay_id")) %>%
left_join(study_index, by = c("study_id" = "old_id")) %>%
left_join(block_index, by = c("block_id" = "old_id")) %>%
select(block_id = new_id.y, study_id = new_id.x, assay_id = new_assay_id)
assay_index <- read.csv("../data/tmp/fallahi/assay_index.csv", stringsAsFactors = FALSE)
study_index <- read.csv("../data/tmp/study_index.csv", stringsAsFactors = FALSE)
block_index <- read.csv("../data/tmp/fallahi/block_index.csv",
stringsAsFactors = FALSE)
source_table <- read.csv("../data/raw/Fallahi_melanuma_result/Upload/source.csv",
stringsAsFactors = FALSE) %>%
left_join(assay_index, by = c("assay_id" = "old_assay_id")) %>%
left_join(study_index, by = c("study_id" = "old_id")) %>%
left_join(block_index, by = c("block_id" = "old_id")) %>%
select(block_id = new_id.y, study_id = new_id.x, assay_id = new_assay_id)
min(source_table$block_id)
max(source_table$block_id)
max(source_table$block_id) - min(source_table$block_id) + 1 == nrow(source_table)
unique(source_table$study_id)
unique(source_table$assay_id)
table(table(source_table$block_id))
table(source_table$assay_id)
table(source_table$study_id)
apply(source_table, 2, function(x){sum(is.na(x))})
write.csv(source_table, "../data/output/fallahi/source.csv", row.names = FALSE)
template <- read.table("../data/raw/DOWNLOAD-schqBu4YUrVii0dxdCDmVxoQNFN-Dse2LGE4_76NFKE=.csv",
sep = ";", stringsAsFactors = FALSE, strip.white = TRUE,
header = TRUE)
drug_original <- select(template, Molecule.ChEMBL.ID, Molecule.Name, Compound.Key, Molecule.Max.Phase, Smiles)
library(tidyverse)
library(TidyComb)
library(openxlsx)
library(DBI)
GetPubNamesSID <- function(sids, quiet = FALSE){
if (!quiet) {
message("Getting names from PubChem...")
}
url.base <- paste0("https://pubchem.ncbi.nlm.nih.gov/rest/pug/substance/sid/",
"%s", "/synonyms/JSON")
# Build containers
sid <- NULL
name <- NULL
synonyms <- NULL
df <- data.frame(sid = integer(), name = character(), synonyms = character())
i <- 1
n <- length(sids)
for (compound in sids) {
tryCatch({
if (!quiet) {
message(round(i/n, 2)*100, "% completed", "\r", appendLF = FALSE)
utils::flush.console()
}
url <- sprintf(url.base, compound)
res <- jsonlite::fromJSON(url)
sid <- c(sid, res$InformationList$Information$SID)
names <- unlist(res$InformationList$Information$Synonym)
j <- 1
dname <- paste0(rep(1, 41), collapse = "")
while(nchar(dname) > 40 & j < length(names)){
dname <- names[j]
j <- j + 1
}
if (nchar(dname) > 40){
dname <- names[1]
}
name <- c(name, dname)
synonyms <- c(synonyms,
paste0(names, collapse = "; "))
}, error = function(e){
if (!quiet){
print(e)
}
url <- sub("/synonyms", "", url)
res <- jsonlite::fromJSON(url)
sid <<- c(sid, res$PC_Substances$sid$id)
names <- res$PC_Substances$synonyms
j <- 0
dname <- paste0(rep(1, 41), collapse = "")
while(nchar(dname) > 40 & j < length(names)){
j <- j + 1
dname <- names[j]
}
if (nchar(dname) > 40){
dname <- names[1]
}
name <<- c(name, dname)
synonyms <<- c(synonyms,
paste0(names, collapse = "; "))
}, finally = Sys.sleep(0.2)
)
i <- i + 1
}
df <- data.frame(sid = sid, name = name, synonyms = synonyms,
stringsAsFactors = FALSE)
return(df)
}
template <- read.table("../data/raw/DOWNLOAD-schqBu4YUrVii0dxdCDmVxoQNFN-Dse2LGE4_76NFKE=.csv",
sep = ";", stringsAsFactors = FALSE, strip.white = TRUE,
header = TRUE)
drug_original <- select(template, Molecule.ChEMBL.ID, Molecule.Name, Compound.Key, Molecule.Max.Phase, Smiles)
rm(list = ls())
tmp <- read.table("../data/raw/DOWNLOAD-schqBu4YUrVii0dxdCDmVxoQNFN-Dse2LGE4_76NFKE=.csv",
sep = ";", stringsAsFactors = FALSE, strip.white = TRUE,
header = TRUE)
table(tmp$Assay.Description)
tmp_inhibition <- tmp %>%
filter(Assay.Description == "Antiviral activity determined as inhibition of SARS-CoV-2 induced cytotoxicity of Caco-2 cells at 10 uM after 48 hours by high content imaging") %>%
select(chembl_id = "Molecule.ChEMBL.ID", inhibition = "Standard.Value")
tmp_ic50 <- tmp %>%
filter(Assay.Description == "Determination of IC50 values for inhibition of SARS-CoV-2 induced cytotoxicity of Caco-2 cells after 48 hours by high content imaging") %>%
mutate(IC50 = Standard.Value / 10 ^ 3) %>%
select(chembl_id = "Molecule.ChEMBL.ID", IC50)
template <- left_join(tmp_inhibition, tmp_ic50, by = "chembl_id")
1445468 - 88
response_table <- template %>%
mutate(block_id = seq(1445380, length.out = n()),
conc_r = rep(10, n()),
conc_c = rep(NA, n()),
synergy_zip = rep(NA, n()),
synergy_bliss = rep(NA, n()),
synergy_loewe = rep(NA, n()),
synergy_hsa = rep(NA, n())) %>%
select(block_id, conc_r, conc_c, inhibition, synergy_zip, synergy_bliss,
synergy_loewe, synergy_hsa)
min(response_table$block_id)
max(response_table$block_id)
table(table(response_table$block_id))
apply(response_table, 2, function(x){sum(is.na(x))})
write.csv(response_table, "../data/upload/response.csv", row.names = FALSE)
drug_index <- read.csv("../data/tmp/drug_index.csv", stringsAsFactors = FALSE)
summary_table <- template %>%
left_join(drug_index, by = "chembl_id") %>%
rename(drug_row_id = id) %>%
mutate(block_id = seq(1445468, length.out = n()),
drug_col_id = rep(NA, n()),
conc_r_unit = rep("uM", n()),
conc_c_unit = rep(NA, n()),
cell_line_id = rep(224, n()),
synergy_zip = rep(NA, n()),
synergy_bliss = rep(NA, n()),
synergy_loewe = rep(NA, n()),
synergy_hsa = rep(NA, n()),
ic50_row = IC50,
ic50_col = rep(NA, n()),
ri_row = inhibition,
ri_col = rep(NA, n()),
css_row = rep(NA, n()),
css_col = rep(NA, n()),
S_mean = rep(NA, n()),
S_max = rep(NA, n()),
S_sum = rep(NA, n()),
quality = ifelse(inhibition > 200 | inhibition < -200, "bad", NA),
css_ri = inhibition) %>%
select(block_id, drug_row_id, drug_col_id, cell_line_id, conc_r_unit,
conc_c_unit, synergy_zip, synergy_bliss, synergy_loewe, synergy_hsa,
ic50_row, ic50_col, ri_row, ri_col, css_row, css_col, S_sum, S_mean,
S_max, quality, css_ri)
drug_index <- read.csv("../data/tmp/drug_index.csv", stringsAsFactors = FALSE)
summary_table <- template %>%
left_join(drug_index, by = "chembl_id") %>%
rename(drug_row_id = id) %>%
mutate(block_id = seq(1445380, length.out = n()),
drug_col_id = rep(NA, n()),
conc_r_unit = rep("uM", n()),
conc_c_unit = rep(NA, n()),
cell_line_id = rep(224, n()),
synergy_zip = rep(NA, n()),
synergy_bliss = rep(NA, n()),
synergy_loewe = rep(NA, n()),
synergy_hsa = rep(NA, n()),
ic50_row = IC50,
ic50_col = rep(NA, n()),
ri_row = inhibition,
ri_col = rep(NA, n()),
css_row = rep(NA, n()),
css_col = rep(NA, n()),
S_mean = rep(NA, n()),
S_max = rep(NA, n()),
S_sum = rep(NA, n()),
quality = ifelse(inhibition > 200 | inhibition < -200, "bad", NA),
css_ri = inhibition) %>%
select(block_id, drug_row_id, drug_col_id, cell_line_id, conc_r_unit,
conc_c_unit, synergy_zip, synergy_bliss, synergy_loewe, synergy_hsa,
ic50_row, ic50_col, ri_row, ri_col, css_row, css_col, S_sum, S_mean,
S_max, quality, css_ri)
min(summary_table$block_id)
max(summary_table$block_id)
max(summary_table$cell_line_id)
max(c(summary_table$drug_row_id, summary_table$drug_col_id),
na.rm = TRUE)
table(table(summary_table$block_id))
apply(summary_table, 2, function(x){sum(is.na(x))})
View(summary_table)
source_table <- response_table %>%
select(block_id) %>%
mutate(assay_id = rep(98, n()),
study_id = rep(32, n()))
write.csv(source_table, "../data/upload/source.csv", row.names = FALSE)
sessionInfo()
library(TidyComb)
library(tidyverse)
drug_id_change_table <- data.frame(old_id = seq(4599, 4602),
new_id = seq(4603, 4606),
stringsAsFactors = FALSE) %>%
rbind.data.frame(read.csv("../../2020.11.30_update_drug_table/data/output/drug_id_change_table.csv",
stringsAsFactors = FALSE))
write.csv(drug_id_change_table, "../data/tmp/drug_id_change_table.csv", row.names = FALSE)
rm(list = ls())
files <- grep("response", list.files("../data/raw/final/", full.names = TRUE), value = TRUE)
response_table <- NULL
for (f in files){
tmp <- read.csv(f, stringsAsFactors = FALSE, header = TRUE)
response_table <- rbind.data.frame(response_table, tmp)
}
min(response_table$block_id)
max(response_table$block_id)
max(response_table$block_id) - min(response_table$block_id) + 1 == length(unique(response_table$block_id))
table(table(response_table$block_id))
apply(response_table, 2, function(x){sum(is.na(x))})
response_table <- response_table %>%
arrange(block_id, conc_r, conc_c) %>%
mutate(block_id_new = group_indices(response_table, block_id) + 1176501) # block_id starts from 1468172
block_index <- response_table %>%
select(old_id = block_id, new_id = block_id_new) %>%
unique()
response_table <- response_table %>%
arrange(block_id_new, conc_r, conc_c) %>%
select(block_id = block_id_new, conc_r, conc_c, inhibition, synergy_zip, synergy_bliss, synergy_loewe,
synergy_hsa)
write.csv(block_index, "../data/tmp/block_index.csv", row.names = FALSE)
min(response_table$block_id)
max(response_table$block_id)
max(response_table$block_id) - min(response_table$block_id) + 1 == length(unique(response_table$block_id))
length(unique(response_table$block_id))
table(table(response_table$block_id))
apply(response_table, 2, function(x){sum(is.na(x))})
write.csv(response_table, "../data/output/response.csv", row.names = FALSE)
bad_quality <- response_table %>%
filter(inhibition < -200 | inhibition > 200) %>%
select(block_id) %>%
unique()
rm(list = ls())
drug_index <- read.csv("../data/tmp/drug_id_change_table.csv", stringsAsFactors = FALSE)
block_index <- read.csv("../data/tmp/block_index.csv", stringsAsFactors = FALSE)
files <- grep("summary", list.files("../data/raw/final/", full.names = TRUE), value = TRUE)
summary_table <- NULL
for (f in files){
tryCatch({
tmp <- read.csv(f, stringsAsFactors = FALSE, header = TRUE)
colnames(tmp)[which(colnames(tmp) == "cell_lind_id")] <- "cell_line_id"
if (ncol(tmp) == 1){
tmp <- read.table(f, sep = ";", stringsAsFactors = FALSE, header = TRUE)
}
if (!"drug_col_id" %in% colnames(tmp)){
tmp <- rename(tmp, drug_col_id = "drug_col")
}
if (!"drug_row_id" %in% colnames(tmp)){
tmp <- rename(tmp, drug_row_id = "drug_row")
}
if (!"cell_line_id" %in% colnames(tmp)){
tmp <- rename(tmp, cell_line_id = "cell_line_name")
}
}, error = function(e){
print(e)
})
summary_table <- rbind.data.frame(summary_table, tmp)
}
min(summary_table$block_id)
max(summary_table$block_id)
max(summary_table$block_id) - min(summary_table$block_id) + 1 == nrow(summary_table)
nrow(summary_table)
sum(duplicated(summary_table$block_id))
max(c(summary_table$drug_row_id, summary_table$drug_col_id))
table(table(summary_table$block_id))
apply(summary_table, 2, function(x){sum(is.na(x))})
for (i in 1:nrow(drug_index)) {
summary_table$drug_row[which(summary_table$drug_row == drug_index$old_id[i])] <- drug_index$new_id[i]
summary_table$drug_col[which(summary_table$drug_col == drug_index$old_id[i])] <- drug_index$new_id[i]
}
summary_table <- summary_table %>%
left_join(block_index, by = c("block_id" = "old_id")) %>%
mutate(quality = rep(NA, n())) %>%
arrange(new_id, drug_row_id, drug_col_id) %>%
select(block_id = new_id, drug_row_id = drug_row, drug_col_id = drug_col,
cell_line_id, conc_r_unit, conc_c_unit, synergy_zip,
synergy_bliss, synergy_loewe, synergy_hsa, ic50_row, ic50_col, ri_row,
ri_col, css_row, css_col, S_sum, S_mean, S_max, quality, css_ri = css) %>%
unique()
min(summary_table$block_id)
max(summary_table$block_id)
max(c(summary_table$drug_row_id, summary_table$drug_col_id))
unique(summary_table$cell_line_id)
max(summary_table$block_id) - min(summary_table$block_id) + 1 == nrow(summary_table)
table(table(summary_table$block_id))
apply(summary_table, 2, function(x){sum(is.na(x))})
write.csv(summary_table, "../data/output/summary.csv", row.names = FALSE)
rm(list = ls())
block_index <- read.csv("../data/tmp/block_index.csv", stringsAsFactors = FALSE)
files <- grep("surface", list.files("../data/raw/final/", full.names = TRUE), value = TRUE)
surface_table <- NULL
for (f in files){
tmp <- read.csv(f, stringsAsFactors = FALSE, header = TRUE)
surface_table <- rbind.data.frame(surface_table, tmp)
}
min(surface_table$block_id)
max(surface_table$block_id)
max(surface_table$block_id) - min(surface_table$block_id) + 1 == length(unique(surface_table$block_id))
table(table(surface_table$block_id))
apply(surface_table, 2, function(x){sum(is.na(x))})
surface_table <- surface_table %>%
left_join(block_index, by = c("block_id" = "old_id")) %>%
select(conc_r, conc_c, inhibition, block_id = new_id, synergy_zip,
synergy_bliss, synergy_hsa, synergy_loewe) %>%
arrange(block_id, conc_r, conc_c) %>%
unique()
min(surface_table$block_id)
max(surface_table$block_id)
max(surface_table$block_id) - min(surface_table$block_id) + 1 == length(unique(surface_table$block_id))
table(table(surface_table$block_id))
apply(surface_table, 2, function(x){sum(is.na(x))})
write.csv(surface_table, "../data/output/surface.csv", row.names = FALSE)
rm(list = ls())
drug_index <- read.csv("../data/tmp/drug_id_change_table.csv", stringsAsFactors = FALSE)
block_index <- read.csv("../data/tmp/block_index.csv", stringsAsFactors = FALSE)
files <- grep("curve", list.files("../data/raw/final/", full.names = TRUE), value = TRUE)
curve_table <- NULL
for (f in files){
tmp <- read.csv(f, stringsAsFactors = FALSE, header = TRUE)
curve_table <- rbind.data.frame(curve_table, tmp)
}
min(curve_table$block_id)
max(curve_table$block_id)
max(curve_table$block_id) - min(curve_table$block_id) + 1 == nrow(curve_table) / 2
table(table(curve_table$block_id))
apply(curve_table, 2, function(x){sum(is.na(x))})
for (i in 1:nrow(drug_index)) {
curve_table$drug_row[which(curve_table$drug_row == drug_index$old_id[i])] <- drug_index$new_id[i]
curve_table$drug_col[which(curve_table$drug_col == drug_index$old_id[i])] <- drug_index$new_id[i]
}
curve_table <- curve_table %>%
left_join(block_index, by = c("block_id" = "old_id")) %>%
select(block_id = new_id, b, c, d, e, model, drug_row_id, drug_col_id) %>%
arrange(block_id, drug_row_id, drug_col_id) %>%
unique()
min(curve_table$block_id)
max(curve_table$block_id)
max(curve_table$block_id) - min(curve_table$block_id) + 1 == nrow(curve_table) / 2
table(table(curve_table$block_id))
apply(curve_table, 2, function(x){sum(is.na(x))})
write.csv(curve_table, "../data/output/curve.csv", row.names = FALSE)
rm(list = ls())
assay_table <- read.csv("../data/raw/assay_cell_name_cell_id.csv", stringsAsFactors = FALSE)
assay_table <- assay_table %>%
select(assay_id, assay_type, plate_format, cell_per_well, detection_technology,
negative_control, negative_control_conc, positive_control,
positive_control_conc_nm, time_h)
write.csv(assay_table, "../data/output/assay.csv", row.names = FALSE)
rm(list = ls())
summary_table <- read.csv("../data/output/summary.csv", stringsAsFactors = FALSE)
assay <- read.csv("../data/raw/assay_cell_name_cell_id.csv", stringsAsFactors = FALSE)
source_table <- summary_table %>%
left_join(assay, by = c("cell_line_id" = "cell_id")) %>%
mutate(study_id = rep(24, n())) %>%
arrange(block_id, study_id, assay_id) %>%
select(block_id, study_id, assay_id)
min(source_table$block_id)
max(source_table$block_id)
max(source_table$block_id) - min(source_table$block_id) + 1 == nrow(source_table)
unique(source_table$study_id)
unique(source_table$assay_id)
table(table(source_table$block_id))
table(table(source_table$assay_id))
table(table(source_table$study_id))
apply(source_table, 2, function(x){sum(is.na(x))})
write.csv(source_table, "../data/output/source.csv", row.names = FALSE)
sessionInfo()
block_index <- read.csv("../data/tmp/malaria1/block_index.csv", stringsAsFactors = FALSE)
files <- list.files("../data/raw/malaria1_NCATS/upload/calculate/output/surface/",
full.names = TRUE)
files <- c(files, "../data/raw/malaria1_NCATS/upload/calculate/surface_eq.csv")
surface_table <- NULL
for (f in files){
tmp <- read.csv(f, stringsAsFactors = FALSE, header = TRUE)
surface_table <- rbind.data.frame(surface_table, tmp)
}
min(surface_table$block_id)
max(surface_table$block_id)
max(surface_table$block_id) - min(surface_table$block_id) + 1 == length(unique(surface_table$block_id))
table(table(surface_table$block_id))
apply(surface_table, 2, function(x){sum(is.na(x))})
surface_table <- surface_table %>%
left_join(block_index, by = c("block_id" = "old_id")) %>%
select(conc_r, conc_c, inhibition, block_id = new_id, synergy_zip,
synergy_bliss, synergy_hsa, synergy_loewe) %>%
unique()
library(TidyComb)
library(tidyverse)
surface_table <- surface_table %>%
left_join(block_index, by = c("block_id" = "old_id")) %>%
select(conc_r, conc_c, inhibition, block_id = new_id, synergy_zip,
synergy_bliss, synergy_hsa, synergy_loewe) %>%
unique()
min(surface_table$block_id)
max(surface_table$block_id)
max(surface_table$block_id) - min(surface_table$block_id) + 1 == length(unique(surface_table$block_id))
table(table(surface_table$block_id))
apply(surface_table, 2, function(x){sum(is.na(x))})
for (b in seq(1456572, max(surface_table$block_id), by = 1000)){
tmp <- surface_table[which(surface_table$block_id %in% seq(b, b + 999)), ] %>%
arrange(block_id, conc_r, conc_c)
write.csv(tmp, paste0("../data/output/malaria1/surface_split/surface_",b , ".csv"), row.names = FALSE)
}
for (b in seq(1456572, max(surface_table$block_id), by = 1000)){
tmp <- read.csv(paste0("../data/output/malaria1/surface_split/surface_",b , ".csv"), stringsAsFactors = FALSE)
tmp <- select(tmp, block_id, conc_r, conc_c)
print(b)
print(sum(duplicated(tmp)))
}
rm(list = ls())
files <- c("../../2020.12.17_NTNU_HTS_by_Toulo/data/output/surface.csv",
"../../2020.12.09_merge_my_dataset_change_drug_id/data/output/surface.csv",
"../../2020.12.09_merge_data_from_Toulo/data/output/malaria1/surface.csv",
"../../2020.12.09_merge_data_from_Toulo/data/output/covid/surface.csv",
"../../2020.12.09_merge_data_from_Toulo/data/output/ebola/surface.csv",
"../../2020.12.09_merge_data_from_Toulo/data/output/fallahi/surface.csv"
)
surface_table <- NULL
for (f in files){
tmp <- read.csv(f, stringsAsFactors = FALSE, header = TRUE)
if (ncol(tmp) == 1){
tmp <- read.table(f, sep = ";", stringsAsFactors = FALSE, header = TRUE)
}
surface_table <- rbind.data.frame(surface_table, tmp)
}
surface_table <- arrange(surface_table, block_id, conc_r, conc_c)
min(surface_table$block_id)
max(surface_table$block_id)
max(surface_table$block_id) - min(surface_table$block_id) + 1 == length(unique(surface_table$block_id))
table(table(surface_table$block_id))
apply(surface_table, 2, function(x){sum(is.na(x))})
surface_table <- read.csv("../data/output/surface.csv", stringsAsFactors = FALSE)
surface_table <- filter(surface_table, block_id > 1468171)
write.csv(surface_table, "../data/output/surface_1468172.csv", row.names = FALSE)
surface_table <- select(block_id, conc_c, conc_r)
surface_table <- select(surface_table, block_id, conc_c, conc_r)
sum(duplicated(surface_table))
setwd("~/Documents/work/SynergyFinder_shiny_app/SynergyFinder")
